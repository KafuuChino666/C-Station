<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.o0u0o.service.video.mapper.VAuditStatusMapper">
    <update id="lockAudit">
        update v_audit_status set auditor = #{username}, audit_status = 1 where id = #{id} and auditor = '#'
    </update>

    <select id="selectFlowFirstNode" resultType="java.lang.Integer">
        select id from work_flow_line where flow_id = #{flow_id} and prev_node_id = 0
    </select>
    <select id="selectListByNodeId" resultType="cn.o0u0o.service.video.entity.vo.VideoAuditListItem">
        select vas.gmt_modified, vas.auditor, discipline_info, auditor_info, vas.id, v.id 'videoId', v.author_id, v.video_title, z.title 'zoneTitle' from v_audit_status vas
             left join v_video v on vas.v_id = v.id
             left join pub_zone z on z.id = v.zone_id
        where vas.current_node = #{nodeId}
    </select>
    <select id="selectUnfinishedByAuditor" resultType="java.lang.Integer">
        select COUNT(*) from v_audit_status where auditor = #{username}
    </select>
</mapper>
